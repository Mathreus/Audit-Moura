WITH DadosBase AS (
    SELECT 
        *,
        CASE 
            WHEN PESO IS NULL OR PESO = 0 THEN NULL
            ELSE CUSTO_FINANCEIRO / PESO 
        END AS CUSTO_UNITARIO
    FROM 
        VW_AUDIT_RM_GERENCIAMENTO_ESTOQUE
    WHERE 
        COD_ESTABELECIMENTO = 'R151' -- ALTERAR PARA O DISTRIBUIDOR QUE IRÁ SER AUDITADO!!!
        AND DATA BETWEEN '2025-07-01' AND '2025-12-31' -- ALTERAR PARA O PERÍODO QUE SERÁ AUDITADO!!!
        AND TIPO_OPERACAO = '1.7.006'
)
SELECT 
    *,
    CASE
        WHEN CUSTO_UNITARIO > 5.41 THEN 'Ponto'
        WHEN CUSTO_UNITARIO < 5.41 THEN 'OK'
        ELSE 'N/A'
    END AS CLASSIFICACAO
FROM 
    DadosBase
WHERE 
    CUSTO_UNITARIO > 5.41
ORDER BY 
    CUSTO_UNITARIO DESC;
